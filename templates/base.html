<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Escolinha Aurora Tech{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
{% if request.endpoint != 'auth.login' %}
<div class="app-shell">
    <!-- SIDEBAR -->
    <aside class="sidebar">
        <div>
            <div class="sidebar-logo">
                <div class="sidebar-logo-icon">EA</div>
                <div class="sidebar-logo-text">
                    <span class="sidebar-logo-title">
                        {% if current_user.escolinha_nome %}
                            {{ current_user.escolinha_nome }}
                        {% else %}
                            Escolinha Aurora Tech
                        {% endif %}
                    </span>
                    <span class="sidebar-logo-subtitle">Portal do Aluno e GestÃ£o</span>
                </div>
            </div>

            <ul class="sidebar-nav">
                {% set ep = request.endpoint or '' %}

                <li><a href="{{ url_for('dashboard.index') }}"
                       class="{% if ep.startswith('dashboard') %}active{% endif %}">
                    <span class="icon">ğŸ </span> VisÃ£o Geral
                </a></li>

                <li><a href="{{ url_for('atletas.listar') }}"
                       class="{% if ep.startswith('atletas') %}active{% endif %}">
                    <span class="icon">ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦</span> Alunos & ResponsÃ¡veis
                </a></li>

                <li><a href="{{ url_for('grupos.listar') }}"
                       class="{% if ep.startswith('grupos') %}active{% endif %}">
                    <span class="icon">ğŸ‘¥</span> Grupos
                </a></li>

                <li><a href="{{ url_for('planos.listar') }}"
                       class="{% if ep.startswith('planos') %}active{% endif %}">
                    <span class="icon">ğŸ«</span> Planos
                </a></li>

                <li><a href="{{ url_for('atividades.agenda') }}"
                       class="{% if ep.startswith('atividades') %}active{% endif %}">
                    <span class="icon">ğŸ“…</span> Agenda
                </a></li>

                <li><a href="{{ url_for('financeiro.fluxo_caixa') }}"
                       class="{% if ep.startswith('financeiro') %}active{% endif %}">
                    <span class="icon">ğŸ’°</span> Fluxo de Caixa
                </a></li>

                <li><a href="{{ url_for('usuarios_sistema.listar') }}"
                       class="{% if ep.startswith('usuarios_sistema') %}active{% endif %}">
                    <span class="icon">ğŸ§‘â€ğŸ’»</span> UsuÃ¡rios do Sistema
                </a></li>

                <li><a href="{{ url_for('ia.index') }}"
                       class="{% if ep.startswith('ia') %}active{% endif %}">
                    <span class="icon">ğŸ¤–</span> IA Coach
                </a></li>
            </ul>
        </div>

        {% if current_user.is_authenticated %}
        <div class="sidebar-user">
            <div class="sidebar-user-info">
                <span class="sidebar-user-name">{{ current_user.nome }}</span>
                <span class="sidebar-user-role">{{ current_user.role }}</span>
            </div>
            <div>
                <div class="sidebar-user-status-pill">
                    â— Online
                </div>
                <form method="post" action="{{ url_for('auth.logout') }}" style="margin-top:0.35rem;">
                    <button type="submit" class="btn btn-sm btn-outline">Sair</button>
                </form>
            </div>
        </div>
        {% endif %}
    </aside>

    <!-- MAIN -->
    <main class="main">
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div style="margin-bottom:0.75rem;">
              {% for category, message in messages %}
                <div class="badge badge-{{ 'danger' if category == 'error' else 'neutral' }}">{{ message }}</div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    </main>
</div>
{% else %}
    {% block content %}{% endblock %}
{% endif %}
</body>
</html>